import{i as Q,r as p,j as x,h as d,k as z,c as f,a as o,t as m,w as M,v as y,l as W,f as h,n as C,m as n,F as E,p as Y,u as V,o as S,q as L}from"./index-d4-rZQFT.js";import{s as u,S as j}from"./Toast-BGAkXIA8.js";import{u as O}from"./UserStore-DkA0qPc0.js";const B="data:image/png;base64,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",U=Q("todoStore",()=>{const l=p([]),i=p("all"),s=x(()=>i.value==="finish"?l.value.filter(t=>t.checked):i.value==="unfinish"?l.value.filter(t=>!t.checked):l.value),v=x(()=>l.value.filter(t=>!t.checked).length),c=async()=>{try{const t=await d.get("https://todoo.5xcamp.us/todos");l.value=t.data.todos.map(e=>({id:e.id,content:e.content,checked:!!e.completed_at}))}catch(t){return console.log(t)}};return{todos:l,currentFilter:i,filteredTodos:s,unfinishCount:v,getTodos:c,addTodo:async t=>{if(t.trim())try{await d.post("https://todoo.5xcamp.us/todos",{todo:{content:t}}),u("success","新增資料成功"),c()}catch(e){console.error(e),u("error","新增失敗，請稍後再試")}},editTodo:async t=>{try{await d.put(`https://todoo.5xcamp.us/todos/${t.id}`,{todo:{content:t.content}}),u("success","編輯資料成功"),c()}catch(e){return console.log(e)}},toggleTodo:async t=>{await d.patch(`https://todoo.5xcamp.us/todos/${t}/toggle`),c()},delTodo:async t=>{try{const e=await d.delete(`https://todoo.5xcamp.us/todos/${t.id}`);u("success","刪除資料成功"),c()}catch(e){return console.log(e)}},clearCompleted:()=>{const t=l.value.filter(a=>a.checked);let e=0;t.forEach(a=>{d.delete(`https://todoo.5xcamp.us/todos/${a.id}`).then(()=>{e++,e===t.length&&c()})}),u("success","已刪除所有完成項目")}}}),w={class:"todolist_page bg-primary p-3"},H={class:"d-flex flex-row"},I={class:"ms-auto"},Z={class:"d-none d-md-inline"},F={class:"container todolist"},R={class:"card input flex-row justify-content-between"},X={class:"card card_list"},b={class:"tab"},D={class:"cart_content"},J={class:"list"},P={class:"checkbox"},N=["onUpdate:modelValue","onChange"],G={class:"actions"},K=["onClick"],q=["onClick"],_={class:"list_footer"},ot={__name:"TodoList",setup(l){const i=V(),s=U(),v=O(),c=p(""),T=p(localStorage.getItem("nickname")||"");z(()=>{s.getTodos()});const A=()=>{s.addTodo(c.value),c.value=""},g=async r=>{const{value:t}=await j.fire({title:"請輸入新的代辦內容",input:"text",inputValue:r.content,showCancelButton:!0,confirmButtonText:"確定修改",cancelButtonText:"取消",inputValidator:e=>e.trim()?e.trim()===r.content.trim()?"內容未修改":null:"內容不得為空值"});if(t&&t.trim()!==r.content.trim()){const e={...r,content:t.trim()};s.editTodo(e)}},k=()=>{v.logout(),i.push("/login")};return(r,t)=>(S(),f("div",w,[o("div",H,[t[5]||(t[5]=o("img",{src:B,alt:"logo",class:"img-fluid"},null,-1)),o("div",I,[o("span",Z,m(T.value)+" 的代辦",1),o("a",{href:"#",class:"btn ms-2",onClick:k},"登出")])]),o("div",F,[o("div",R,[M(o("input",{type:"text",class:"input_text",placeholder:"新增待辦事項","onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),onKeydown:W(A,["enter"])},null,544),[[y,c.value]]),o("a",{href:"#",class:"btn_add",onClick:h(A,["prevent"])},"+")]),o("div",X,[o("ul",b,[o("li",{class:C({active:n(s).currentFilter==="all"}),onClick:t[1]||(t[1]=e=>n(s).currentFilter="all")},"全部",2),o("li",{class:C({active:n(s).currentFilter==="unfinish"}),onClick:t[2]||(t[2]=e=>n(s).currentFilter="unfinish")}," 待完成 ",2),o("li",{class:C({active:n(s).currentFilter==="finish"}),onClick:t[3]||(t[3]=e=>n(s).currentFilter="finish")}," 已完成 ",2)]),o("div",D,[o("ul",J,[(S(!0),f(E,null,Y(n(s).filteredTodos,e=>(S(),f("li",{key:e.id},[o("label",P,[M(o("input",{type:"checkbox",class:"checkedMark","onUpdate:modelValue":a=>e.checked=a,onChange:a=>n(s).toggleTodo(e.id)},null,40,N),[[L,e.checked]]),o("span",null,m(e.content),1)]),o("div",G,[o("a",{href:"#",class:"edit",onClick:h(a=>g(e),["prevent"])},"✎",8,K),o("a",{href:"#",class:"delete",onClick:h(a=>n(s).delTodo(e),["prevent"])},"🗑",8,q)])]))),128))]),o("div",_,[o("p",null,m(n(s).unfinishCount)+" 個待完成項目",1),o("a",{href:"#",onClick:t[4]||(t[4]=h((...e)=>n(s).clearCompleted&&n(s).clearCompleted(...e),["prevent"]))},"清除已完成項目")])])])])]))}};export{ot as default};
